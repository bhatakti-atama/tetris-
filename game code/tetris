#include <FastLED.h>
#define LED_PIN 6
# define NUM_LED 126
# define b1 2
# define b2 5
# define b3 3
# define b4 4
CRGB leds[NUM_LED];
uint8_t x[4];
uint8_t y[4];
uint8_t tetris[18][9];
uint8_t ledNumber;
uint8_t condition;
int timeFinal;
int timeInitial;
uint8_t selection;
uint8_t blankRows[14] = {0};
uint8_t emptyRowCounter;
uint8_t gameover;
uint8_t baseX;
uint8_t baseY;
uint8_t tfs;
uint8_t orientation;
void setup() {
  FastLED.addLeds < WS2812, LED_PIN, GRB > (leds, NUM_LED);
  for (int i = 0; i < 14; i++)
  {
    for (int j = 0; j < 9; j++)
    {
      tetris[i][j] = 0;
    }
  }
  for (int i = 0; i < 4; i++)
  {
    x[i] = 0;
    y[i] = 0;
  }
  pinMode(b1, INPUT_PULLUP);
  pinMode(b2, INPUT_PULLUP);
  pinMode(b3, INPUT_PULLUP);
  pinMode(b4, INPUT_PULLUP);
}
int b1Input() {

  if (digitalRead(b1) == LOW) {
    delay(100);
    if (digitalRead(b1) == LOW) {
      return 1;
    } else {
      return 0;
    }
  } else {
    return 0;
  }
}

int b2Input() {
  if (digitalRead(b2) == LOW) {
    delay(100);
    if (digitalRead(b2) == LOW) {
      return 1;
    } else {
      return 0;
    }
  } else {
    return 0;
  }
}

int b3Input() {
  if (digitalRead(b3) == LOW) {
    delay(100);
    if (digitalRead(b3) == LOW) {
      return 1;
    } else {
      return 0;
    }
  } else {
    return 0;
  }
}

int b4Input() {
  if (digitalRead(b4) == LOW) {
    delay(100);
    if (digitalRead(b4) == LOW) {
      return 1;
    } else {
      return 0;
    }
  } else {
    return 0;
  }
}
void erase()
{
  for ( int i = 0 ; i < 4 ; i++)
  {
    tetris[y[i]][x[i]] = 0;
  }
}
void createJBlock0()
{
  x[0] = baseX;
  y[0] = baseY - 1;
  for (int i = 1 ; i <= 3 ; i++)
  {
    x[i] = baseX + i - 1;
    y[i] = baseY;
  }
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 5;
  }
  scan();
}
void createJBlock1()
{
  x[0] = baseX;
  x[1] = baseX;
  x[2] = baseX - 1;
  x[3] = baseX;
  y[0] = baseY - 2;
  y[1] = baseY - 1;
  y[2] = baseY;
  y[3] = baseY;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 5;
  }
  scan();
}
void createJBlock2()
{
  for ( int i = 0 ; i < 3 ; i++)
  {
    x[i] = baseX - 2 + i;
    y[i] = baseY;
  }
  x[3] = baseX;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 5;
  }
  scan();
}
void createJBlock3()
{
  x[0] = baseX;
  x[1] = baseX + 1;
  x[2] = baseX;
  x[3] = baseX;
  y[0] = baseY;
  y[1] = baseY;
  y[2] = baseY + 1;
  y[3] = baseY + 2;
  for ( int i = 0 ; i < 4 ; i ++)
  {
    tetris[y[i]][x[i]] = 5;
  }
  scan();
}
void jBlock()
{
  orientation = 0;
  baseX = 2;
  baseY = 4;
  condition = 1;
  tfs = 0;
  while (condition == 1)
  {
    if ( orientation == 0)
    {
      createJBlock0();
      scan();
      if ( baseY < 17 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock0();
          }
          if (baseX < 6 && b2Input() == 1 && tetris[baseY][baseX + 3] == 0)
          {
            erase();
            baseX = baseX + 1;
            createJBlock0();
          }
          if ( baseY > 2 && baseX > 0 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 2][baseX] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createJBlock0();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock0();
          }
          if (baseX < 6 && b2Input() == 1 && tetris[baseY][baseX + 3] == 0)
          {
            erase();
            baseX = baseX + 1;
            createJBlock0();
          }
          if ( baseY > 2 && baseX > 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 2][baseX] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 17 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 1)
    {
      createJBlock1();
      scan();
      if ( baseY < 17 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock1();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 1][baseX + 1] == 0  && tetris[baseY - 2][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createJBlock1();
          }
          if ( baseY < 17 && baseX > 1 && tetris[baseY + 1][baseX] == 0 && tetris[baseY][baseX - 2] == 0 && b3Input() == 1)
          {
            orientation = 2;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createJBlock1();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock1();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 1][baseX + 1] == 0  && tetris[baseY - 2][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createJBlock1();
          }

        }
        if ( baseY < 17 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 2)
    {
      createJBlock2();
      scan();
      if ( baseY < 16 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[0] + 1][x[0]] == 0  && tetris[y[1] + 1][x[1]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 2)
        {
          timeFinal = millis();
          if (baseX >  2 && b1Input() == 1 && tetris[baseY][baseX - 3] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock2();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createJBlock2();
          }
          if ( baseY < 16 && baseX < 8 && tetris[baseY + 2][baseX] == 0 && tetris[baseY][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 3;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createJBlock2();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 2)
        {
          timeFinal = millis();
          if (baseX >  2 && b1Input() == 1 && tetris[baseY][baseX - 3] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock2();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createJBlock2();
          }
        }

        if ( baseY < 16 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[0] + 1][x[0]] == 0 && tetris[y[1] + 1][x[1]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 3)
    {
      createJBlock3();
      scan();
      if ( baseY < 15 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[1] + 1][x[1]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 3)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX - 1] == 0 && tetris[baseY + 2][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock3();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 )
          {
            erase();
            baseX = baseX + 1;
            createJBlock3();
          }
          if ( baseY > 0 && baseX < 7 && tetris[baseY - 1][baseX] == 0 && tetris[baseY][baseX + 2] == 0 && b3Input() == 1)
          {
            orientation = 0;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createJBlock3();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 3)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX - 1] == 0 && tetris[baseY + 2][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createJBlock3();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 )
          {
            erase();
            baseX = baseX + 1;
            createJBlock3();
          }
        }

        if ( baseY < 15 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[1] + 1][x[1]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
  }
}
void createLBlock0()
{
  x[0] = baseX ;
  x[1] = baseX - 2;
  x[2] = baseX - 1;
  x[3] = baseX ;
  y[0] = baseY - 1;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 3;
  }
  scan();
}
void createLBlock1()
{
  x[0] = baseX;
  x[1] = baseX;
  x[2] = baseX;
  x[3] = baseX + 1;
  y[0] = baseY - 2;
  y[1] = baseY - 1;
  y[2] = baseY;
  y[3] = baseY;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 3;
  }
  scan();
}
void createLBlock2()
{
  x[0] = baseX ;
  x[1] = baseX + 1;
  x[2] = baseX + 2;
  x[3] = baseX;
  y[0] = baseY;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 3;
  }
  scan();
}
void createLBlock3()
{
  x[0] = baseX;
  x[1] = baseX + 1;
  x[2] = baseX + 1;
  x[3] = baseX + 1;
  y[0] = baseY;
  y[1] = baseY;
  y[2] = baseY + 1 ;
  y[3] = baseY + 2;
  for ( int i = 0 ; i < 4 ; i ++)
  {
    tetris[y[i]][x[i]] = 3;
  }
  scan();
}
void lBlock()
{
  orientation = 0;
  baseX = 4;
  baseY = 4;
  condition = 1;
  tfs = 0;
  while (condition == 1)
  {
    if ( orientation == 0)
    {
      createLBlock0();
      scan();
      if ( baseY < 17 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  2 && b1Input() == 1 && tetris[baseY][baseX - 3] == 0 && tetris[baseY - 1][baseX - 1] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createLBlock0();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createLBlock0();
          }
          if ( baseX < 8 && baseY > 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 2][baseX] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createLBlock0();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  2 && b1Input() == 1 && tetris[baseY][baseX - 3] == 0 && tetris[baseY - 1][baseX - 1] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createLBlock0();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createLBlock0();
          }
          if ( baseX < 8 && baseY > 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 2][baseX] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 17 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 1)
    {
      createLBlock1();
      scan();
      if ( baseY < 17 &&  tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY - 2][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createLBlock1();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY - 2 ][baseX + 1] == 0  && tetris[baseY ][baseX + 2] == 0)
          {
            erase();
            baseX = baseX + 1;
            createLBlock1();
          }
          if ( baseX < 7 && baseY < 17 && tetris[baseY ][baseX + 2] == 0 && tetris[baseY - 1][baseX] == 0 && b3Input() == 1)
          {
            orientation = 2;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createLBlock1();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY - 2][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createLBlock1();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY - 2 ][baseX + 1] == 0  && tetris[baseY ][baseX + 2] == 0)
          {
            erase();
            baseX = baseX + 1;
            createLBlock1();
          }
          if ( baseX < 7 && baseY < 17 && tetris[baseY ][baseX + 2] == 0 && tetris[baseY - 1][baseX] == 0 && b3Input() == 1)
          {
            orientation = 2;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 17 &&  tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 2)
    {
      createLBlock2();
      scan();
      if ( baseY < 16 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0  && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 2)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createLBlock2();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 3] == 0 && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createLBlock2();
          }
          if ( baseY < 16  && baseX > 0 && tetris[baseY - 2][baseX] == 0 && tetris[baseY][baseX - 1] == 0 && b3Input() == 1)
          {
            orientation = 3;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createLBlock2();
        }
      }
      else
      {
        while ( timeFinal  - timeInitial < 1000 && orientation == 2)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createLBlock2();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 3] == 0 && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createLBlock2();
          }
          if ( baseY < 16  && baseX > 0 && tetris[baseY - 2][baseX] == 0 && tetris[baseY][baseX - 1] == 0 && b3Input() == 1)
          {
            orientation = 3;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 16 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0  && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 3)
    {
      createLBlock3();
      scan();
      if ( baseY < 15 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 3)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY - 2][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createLBlock3();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY - 2][baseX + 1] == 0 )
          {
            erase();
            baseX = baseX + 1;
            createLBlock3();
          }
          if ( baseX > 2 && tetris[baseY][baseX - 2] == 0 && tetris[baseY - 1][baseX] == 0 && b3Input() == 1)
          {
            orientation = 0;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createLBlock3();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 3)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY - 2][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createLBlock3();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY - 2][baseX + 1] == 0 )
          {
            erase();
            baseX = baseX + 1;
            createLBlock3();
          }
          if ( baseX > 2 && tetris[baseY][baseX - 2] == 0 && tetris[baseY - 1][baseX] == 0 && b3Input() == 1)
          {
            orientation = 0;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 15 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
  }
}
void createSBlock0()
{
  x[0] = baseX ;
  x[1] = baseX + 1;
  x[2] = baseX - 1;
  x[3] = baseX ;
  y[0] = baseY;
  y[1] = baseY;
  y[2] = baseY + 1;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 4;
  }
  scan();
}
void createSBlock1()
{
  x[0] = baseX;
  x[1] = baseX;
  x[2] = baseX + 1;
  x[3] = baseX + 1;
  y[0] = baseY - 1;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 4;
  }
  scan();
}
void sBlock()
{
  orientation = 0;
  baseX = 4;
  baseY = 4;
  condition = 1;
  tfs = 0;
  while (condition == 1)
  {
    if ( orientation == 0)
    {
      createSBlock0();
      scan();
      if ( baseY < 16 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX - 2] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createSBlock0();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 && tetris[baseY - 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createSBlock0();
          }
          if ( baseY < 8 && baseY > 0 && tetris[baseY - 1][baseX] == 0 && tetris[baseY + 1][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createSBlock0();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX - 2] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createSBlock0();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 && tetris[baseY - 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createSBlock0();
          }
          if ( baseY < 8 && baseY > 0 && tetris[baseY - 1][baseX] == 0 && tetris[baseY + 1][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
      }
      if ( orientation == 1)
      {
        createSBlock1();
        scan();
        if ( baseY < 16 &&  tetris[y[1] + 1][x[1]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
        {
          if ( tfs == 0 )
          {
            timeInitial = millis();
            timeFinal = timeInitial;
          }
          else
          {
            tfs = 0;
          }
          while ( timeFinal  - timeInitial < 1000 && orientation == 1)
          {
            timeFinal = millis();
            if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX] == 0 )
            {
              erase();
              baseX = baseX - 1;
              createSBlock1();
            }
            if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY ][baseX + 2] == 0  && tetris[baseY + 1 ][baseX + 2] == 0)
            {
              erase();
              baseX = baseX + 1;
              createSBlock1();
            }
            if ( baseX > 0 && baseY < 17 && tetris[baseY + 1 ][baseX ] == 0 && tetris[baseY + 1][baseX - 1] == 0 && b3Input() == 1)
            {
              orientation = 0;
              tfs = 1;
              erase();
            }
          }
          if (tfs == 0)
          {
            erase();
            baseY = baseY + 1;
            createSBlock1();
          }
        }
        else
        {
          if ( tfs == 0 )
          {
            timeInitial = millis();
            timeFinal = timeInitial;
          }
          else
          {
            tfs = 0;
          }
          while ( timeFinal  - timeInitial < 1000 && orientation == 1)
          {
            timeFinal = millis();
            if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX] == 0 )
            {
              erase();
              baseX = baseX - 1;
              createSBlock1();
            }
            if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY ][baseX + 2] == 0  && tetris[baseY + 1 ][baseX + 2] == 0)
            {
              erase();
              baseX = baseX + 1;
              createSBlock1();
            }
            if ( baseX > 0 && baseY < 17 && tetris[baseY + 1 ][baseX ] == 0 && tetris[baseY + 1][baseX - 1] == 0 && b3Input() == 1)
            {
              orientation = 0;
              tfs = 1;
              erase();
            }
          }
          if ( baseY < 16 &&  tetris[y[1] + 1][x[1]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
          {
            condition = 1;
          }
          else
          {
            condition = 0 ;
          }
        }
      }
    }
  }
}
void straight()
{
  orientation = 0;
  baseX = 2;
  baseY = 4;
  condition = 1;
  tfs = 0;
  while (condition == 1)
  {
    if (orientation == 0)
    {
      for (int i = 0; i < 4; i++)
      {
        x[i] = baseX + i;
        y[i] = baseY;
        tetris[y[i]][x[i]] = 1;
      }
      scan();
      if (y[3] < 17 && (tetris[y[0] + 1][x[0]] == 0) && (tetris[y[1] + 1][x[1]] == 0) && (tetris[y[2] + 1][x[2]] == 0) && (tetris[y[3] + 1][x[3]]) == 0)
      {
        if (tfs == 0)
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while (timeFinal - timeInitial < 500 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX > 0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0)
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX - 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX + i;
              y[i] = baseY;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
          if (baseX < 5 && b2Input() == 1 && tetris[baseY][baseX + 4 ] == 0 )
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX + 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX + i;
              y[i] = baseY;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
          if (baseY > 3 && tetris[baseY - 1][baseX] == 0 && tetris[baseY - 2][baseX] == 0 && tetris[baseY - 3][baseX] == 0 && b3Input() == 1 )
          {
            orientation = 1;
            tfs = 1;
            for (int i = 0; i < 4; i++ )
            {
              tetris[y[i]][x[i]] = 0;
            }
          }
        }
        if ( tfs == 0)
        {
          for ( int i = 0 ; i < 4 ; i++)
          {
            tetris[y[i]][x[i]] = 0;
          }
          baseY = baseY + 1;
          for ( int i = 0 ; i < 4 ; i++)
          {
            x[i] = baseX + i;
            y[i] = baseY;
            tetris[y[i]][x[i]] = 1;
          }
        }
      }
      else
      {
        if (tfs == 0)
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while (timeFinal - timeInitial < 500 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX > 0 && b1Input() == 1 && tetris[baseY][baseX - 1])
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX - 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX + i;
              y[i] = baseY;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
          if (baseX < 5 && b2Input() == 1 && tetris[baseY][baseX + 4 ] == 0 )
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX + 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX + i;
              y[i] = baseY;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
        }
        if (y[3] < 17 && (tetris[y[0] + 1][x[0]] == 0) && (tetris[y[1] + 1][x[1]] == 0) && (tetris[y[2] + 1][x[2]] == 0) && (tetris[y[3] + 1][x[3]]) == 0)
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if (orientation == 1)
    {
      for (int i = 0; i < 4; i++)
      {
        x[i] = baseX;
        y[i] = baseY - i ;
        tetris[y[i]][x[i]] = 1;
      }
      scan();
      if (y[3] < 17 && (tetris[y[0] + 1][x[0]]) == 0)
      {
        if (tfs == 0)
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while (timeFinal - timeInitial < 500 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX > 0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY - 2][baseX - 1] == 0 && tetris[baseY - 3][baseX - 1] == 0)
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX - 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX;
              y[i] = baseY - i;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1 ] == 0 && tetris[baseY - 1][baseX + 1 ] == 0 && tetris[baseY - 2][baseX + 1 ] == 0 && tetris[baseY - 3][baseX + 1 ] == 0)
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX + 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX ;
              y[i] = baseY - i ;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
          if (baseX < 6 && tetris[baseY][baseX + 1] == 0 && tetris[baseY][baseX + 2] == 0 && tetris[baseY][baseX + 3] == 0 && b3Input() == 1 )
          {
            orientation = 0;
            tfs = 1;
            for (int i = 0; i < 4; i++ )
            {
              tetris[y[i]][x[i]] = 0;
            }
          }
        }
        if ( tfs == 0)
        {
          for ( int i = 0 ; i < 4 ; i++)
          {
            tetris[y[i]][x[i]] = 0;
          }
          baseY = baseY + 1;
          for ( int i = 0 ; i < 4 ; i++)
          {
            x[i] = baseX ;
            y[i] = baseY - i;
            tetris[y[i]][x[i]] = 1;
          }
        }
      }
      else
      {
        while (timeFinal - timeInitial < 500 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX > 0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY - 2][baseX - 1] == 0 && tetris[baseY - 3][baseX - 1] == 0)
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX - 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX;
              y[i] = baseY - i;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1 ] == 0 && tetris[baseY - 1][baseX + 1 ] == 0 && tetris[baseY - 2][baseX + 1 ] == 0 && tetris[baseY - 3][baseX + 1 ] == 0)
          {
            for ( int i = 0; i < 4; i++)
            {
              tetris[y[i]][x[i]] = 0;
            }
            baseX = baseX + 1;
            for (int i = 0; i < 4; i++)
            {
              x[i] = baseX ;
              y[i] = baseY - i ;
              tetris[y[i]][x[i]] = 1;
            }
            scan();
          }
        }

        if (y[3] < 17 && (tetris[y[0] + 1][x[0]]) == 0)
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
  }
}
void createTBlock0()
{
  x[0] = baseX;
  x[1] = baseX - 1;
  x[2] = baseX;
  x[3] = baseX + 1;
  y[0] = baseY - 1;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 6;
  }
  scan();
}
void createTBlock1()
{
  x[0] = baseX;
  x[1] = baseX;
  x[2] = baseX + 1;
  x[3] = baseX;
  y[0] = baseY - 1;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 6;
  }
  scan();
}
void createTBlock2()
{
  x[0] = baseX - 1;
  x[1] = baseX;
  x[2] = baseX + 1;
  x[3] = baseX;
  y[0] = baseY;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 6;
  }
  scan();
}
void createTBlock3()
{
  x[0] = baseX;
  x[1] = baseX - 1;
  x[2] = baseX;
  x[3] = baseX;
  y[0] = baseY - 1;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY + 1;
  for ( int i = 0 ; i < 4 ; i ++)
  {
    tetris[y[i]][x[i]] = 6;
  }
  scan();
}
void tBlock()
{
  orientation = 0;
  baseX = 4;
  baseY = 4;
  condition = 1;
  tfs = 0;
  while (condition == 1)
  {
    if ( orientation == 0)
    {
      createTBlock0();
      scan();
      if ( baseY < 17 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY - 1 ][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock0();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 && tetris[baseY - 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createTBlock0();
          }
          if ( baseY < 17 && tetris[baseY + 1][baseX] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createTBlock0();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY - 1 ][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock0();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 && tetris[baseY - 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createTBlock0();
          }
        }
        if ( baseY < 17 && tetris[y[1] + 1][x[1]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 1)
    {
      createTBlock1();
      scan();
      if ( baseY < 16 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY + 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock1();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY ][baseX + 2] == 0  && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createTBlock1();
          }
          if ( baseX > 0 && tetris[baseY ][baseX - 1] == 0 && b3Input() == 1)
          {
            orientation = 2;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createTBlock1();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 && tetris[baseY + 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock1();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY ][baseX + 2] == 0  && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createTBlock1();
          }
        }
        if ( baseY < 16 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 2)
    {
      createTBlock2();
      scan();
      if ( baseY < 16 && tetris[y[0] + 1][x[0]] == 0 && tetris[y[2] + 1][x[2]] == 0  && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 2)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY + 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock2();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createTBlock2();
          }
          if ( baseY > 0 && tetris[baseY - 1][baseX] == 0 && b3Input() == 1)
          {
            orientation = 3;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createTBlock2();
        }
      }
      else
      {
        while ( timeFinal  - timeInitial < 1000 && orientation == 2)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY + 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock2();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY][baseX + 2] == 0 && tetris[baseY + 1][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createTBlock2();
          }
        }
        if ( baseY < 16 && tetris[y[0] + 1][x[0]] == 0 && tetris[y[2] + 1][x[2]] == 0  && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 3)
    {
      createTBlock3();
      scan();
      if ( baseY < 16 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[1] + 1][x[1]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 3)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY + 1][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock3();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY + 1][baseX + 1] == 0 )
          {
            erase();
            baseX = baseX + 1;
            createTBlock3();
          }
          if ( baseX < 8 && tetris[baseY][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 0;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createTBlock3();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 3)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY + 1][baseX - 1] == 0 && tetris[baseY - 1][baseX - 1] == 0 )
          {
            erase();
            baseX = baseX - 1;
            createTBlock3();
          }
          if (baseX < 8 && b2Input() == 1 && tetris[baseY][baseX + 1] == 0 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY + 1][baseX + 1] == 0 )
          {
            erase();
            baseX = baseX + 1;
            createTBlock3();
          }
        }
        if ( baseY < 16 && tetris[y[3] + 1][x[3]] == 0 && tetris[y[1] + 1][x[1]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
  }
}
void createZBlock0()
{
  x[0] = baseX - 1 ;
  x[1] = baseX;
  x[2] = baseX;
  x[3] = baseX + 1;
  y[0] = baseY;
  y[1] = baseY;
  y[2] = baseY + 1;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 7;
  }
  scan();
}
void createZBlock1()
{
  x[0] = baseX + 1;
  x[1] = baseX;
  x[2] = baseX + 1;
  x[3] = baseX;
  y[0] = baseY - 1;
  y[1] = baseY;
  y[2] = baseY;
  y[3] = baseY + 1;
  for ( int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 7;
  }
  scan();
}
void zBlock()
{
  orientation = 0;
  baseX = 4;
  baseY = 4;
  condition = 1;
  tfs = 0;
  while (condition == 1)
  {
    if ( orientation == 0)
    {
      createZBlock0();
      scan();
      if ( baseY < 16 && tetris[y[0] + 1][x[0]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY + 1][baseX - 1] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createZBlock0();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 2] == 0 && tetris[baseY][baseX + 1] == 0)/*here*/
          {
            erase();
            baseX = baseX + 1;
            createZBlock0();
          }
          if ( baseY < 8 && baseY > 0 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createZBlock0();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 0)
        {
          timeFinal = millis();
          if (baseX >  1 && b1Input() == 1 && tetris[baseY][baseX - 2] == 0 && tetris[baseY + 1][baseX - 1] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createZBlock0();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 2] == 0 && tetris[baseY][baseX + 1] == 0)/*here*/
          {
            erase();
            baseX = baseX + 1;
            createZBlock0();
          }
          if ( baseY < 8 && baseY > 0 && tetris[baseY - 1][baseX + 1] == 0 && tetris[baseY][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 1;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 16 && tetris[y[0] + 1][x[0]] == 0 && tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0 )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
    if ( orientation == 1)
    {
      createZBlock1();
      scan();
      if ( baseY < 16  &&  tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX] == 0 && tetris[baseY + 1][baseX - 1] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createZBlock1();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 2] == 0 && tetris[baseY ][baseX + 2] == 0  && tetris[baseY + 1 ][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createZBlock1();
          }
          if ( baseX > 0 && baseY < 17 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 0;
            tfs = 1;
            erase();
          }
        }
        if (tfs == 0)
        {
          erase();
          baseY = baseY + 1;
          createZBlock1();
        }
      }
      else
      {
        if ( tfs == 0 )
        {
          timeInitial = millis();
          timeFinal = timeInitial;
        }
        else
        {
          tfs = 0;
        }
        while ( timeFinal  - timeInitial < 1000 && orientation == 1)
        {
          timeFinal = millis();
          if (baseX >  0 && b1Input() == 1 && tetris[baseY][baseX - 1] == 0 && tetris[baseY - 1][baseX] == 0 && tetris[baseY + 1][baseX - 1] == 0  )
          {
            erase();
            baseX = baseX - 1;
            createZBlock1();
          }
          if (baseX < 7 && b2Input() == 1 && tetris[baseY - 1][baseX + 2] == 0 && tetris[baseY ][baseX + 2] == 0  && tetris[baseY + 1 ][baseX + 1] == 0)
          {
            erase();
            baseX = baseX + 1;
            createZBlock1();
          }
          if ( baseX > 0 && baseY < 17 && tetris[baseY][baseX - 1] == 0 && tetris[baseY + 1][baseX + 1] == 0 && b3Input() == 1)
          {
            orientation = 0;
            tfs = 1;
            erase();
          }
        }
        if ( baseY < 16  &&  tetris[y[2] + 1][x[2]] == 0 && tetris[y[3] + 1][x[3]] == 0  )
        {
          condition = 1;
        }
        else
        {
          condition = 0 ;
        }
      }
    }
  }
}
void scan() { /* check for configutation*/
  ledNumber = 0;
  for (int i = 4; i < 18; i++) { /*18 as number of rows*/
    if ((i % 2) == 0) {
      for (int j = 8; j >= 0; j--) {
        switch (tetris[i][j])
        {
          case 0:
            {
              leds[ledNumber] = CRGB(0, 0, 0);
              break;
            }
          case 1:
            {
              leds[ledNumber] = CRGB(138, 29, 67);
              break;
            }
          case 2:
            {
              leds[ledNumber] = CRGB(67, 29, 138);
              break;
            }
          case 3:
            {
              leds[ledNumber] = CRGB(67, 138, 67);
              break;
            }
          case 4:
            {
              leds[ledNumber] = CRGB(29, 138, 67);
              break;
            }
          case 5:
            {
              leds[ledNumber] = CRGB(29, 67, 138);
              break;
            }
          case 6:
            {
              leds[ledNumber] = CRGB(138, 67, 29);
              break;
            }
          case 7:
            {
              leds[ledNumber] = CRGB(200, 50, 60);
              break;
            }
        }
        ledNumber = ledNumber + 1;
      }
    } else {
      for (int j = 0; j < 9; j++) {
        switch (tetris[i][j])
        {
          case 0:
            {
              leds[ledNumber] = CRGB(0, 0, 0);
              break;
            }
          case 1:
            {
              leds[ledNumber] = CRGB(138, 29, 67);
              break;
            }
          case 2:
            {
              leds[ledNumber] = CRGB(67, 29, 138);
              break;
            }
          case 3:
            {
              leds[ledNumber] = CRGB(67, 138, 67);
              break;
            }
          case 4:
            {
              leds[ledNumber] = CRGB(29, 138, 67);
              break;
            }
          case 5:
            {
              leds[ledNumber] = CRGB(29, 67, 138);
              break;
            }
          case 6:
            {
              leds[ledNumber] = CRGB(138, 67, 29);
              break;
            }
          case 7:
            {
              leds[ledNumber] = CRGB(200, 50, 60);
              break;
            }
        }
        ledNumber = ledNumber + 1;
      }
    }
  }
  FastLED.show();
}
void square()
{
  x[0] = 3; /*tl*/
  x[1] = 4; /*tr*/
  x[2] = 3; /*bl*/
  x[3] = 4; /*br*/
  y[0] = 2; /*tl*/
  y[1] = 2; /*tr*/
  y[2] = 3; /*bl*/
  y[3] = 3; /*br*/
  for (int i = 0; i < 4; i++)
  {
    tetris[y[i]][x[i]] = 2;
  }
  scan();
  condition = 1;
  while (condition == 1)
  {
    if (y[3] < 17 && (tetris[y[2] + 1][x[2]]) == 0 && (tetris[y[3] + 1][x[3]]) == 0)
    {
      timeInitial = millis();
      timeFinal = timeInitial;
      while ((timeFinal - timeInitial) < 1000)
      {
        timeFinal = millis();
        if (b1Input() == 1 && tetris[y[0]][x[0] - 1] == 0 && tetris[y[2]][x[2] - 1] == 0 && x[0] > 0)
        {
          for (int i = 0; i < 4; i++)
          {
            tetris[y[i]][x[i]] = 0;
          }
          for (int i = 0; i < 4; i++)
          {
            x[i] = x[i] - 1;
            tetris[y[i]][x[i]] = 2;
          }
          scan();
        }
        else if (b2Input() == 1 && tetris[y[1]][x[1] + 1] == 0 && tetris[y[3]][x[3] + 1] == 0 && x[1] < 8)
        {
          for (int i = 0; i < 4; i++)
          {
            tetris[y[i]][x[i]] = 0;
          }
          for (int i = 0; i < 4; i++)
          {
            tetris[y[i]][x[i]] = 0;
          }
          for (int i = 0; i < 4; i++)
          {
            x[i] = x[i] + 1;
            tetris[y[i]][x[i]] = 2;
          }
          scan();
        }

      }
      for (int i = 0; i < 4; i++)
      {
        tetris[y[i]][x[i]] = 0;
      }
      for (int i = 0; i < 4; i++)
      {
        y[i] = y[i] + 1;
        tetris[y[i]][x[i]] = 2;
      }
      scan();

    }
    else
    {
      if (b1Input() == 1 && tetris[y[0]][x[0] - 1] == 0 && tetris[y[2]][x[2] - 1] == 0 && x[0] > 0)
      {
        for (int i = 0; i < 4; i++)
        {
          tetris[y[i]][x[i]] = 0;
          x[i] = x[i] - 1;
          tetris[y[i]][x[i]] = 2;
        }
        scan();
      }
      else if (b2Input() == 1 && tetris[y[1]][x[1] + 1] == 0 && tetris[y[3]][x[3] + 1] == 0 && x[1] < 8)
      {
        for (int i = 0; i < 4; i++)
        {
          tetris[y[i]][x[i]] = 0;
        }
        for (int i = 0; i < 4; i++)
        {
          x[i] = x[i] + 1;
          tetris[y[i]][x[i]] = 2;
        }
        scan();
      }
      if (y[3] < 17 && (tetris[y[2] + 1][x[2]]) == 0 && (tetris[y[3] + 1][x[3]]) == 0)
      {

      }
      else
      {
        condition = 0;
      }
      scan();
    }
  }
}
void loop()
{
  selection = random(0, 7);
  switch (selection)
  {

    case 0:
      {
        square();
        break;
      }
    case 1:
      {
        straight();
        break;
      }
    case 2:
      {
        tBlock();
        break;
      }
    case 3:
      {
        lBlock();
        break;
      }
    case 4:
      {
        sBlock();
        break;
      }
    case 5:
      {
        zBlock();
        break;
      }
    case 6:
      {
        jBlock();
        break;
      }

  }
  for (int i = 0; i < 18; i++)
  {
    int check = 1;
    for (int j = 0; j < 9; j++)
    {
      if (tetris[i][j] == 0)
      {
        check = 0;
      }
    }
    if (check == 1)
    {
      for (int j = 0; j < 9; j++)
      {
        tetris[i][j] = 0;
      }
      scan();
      delay(500);
      for (int j = i; j > 0; j--)
      {
        for (int k = 0; k < 9; k++)
        {
          tetris[j][k] = tetris[j - 1][k];
        }
      }
    }
    gameover = 0;

  }
  for (int j = 0 ; j < 9; j++)
  {
    if (tetris[3][j] >= 1)
    {
      gameover = 1;
    }
  }
  if (gameover == 1)
  {
    for (int i = 0 ; i < 18; i++)
    {
      for (int j = 0; j < 9; j++)
      {
        delay(100);
        scan();
      }
    }
  }
}
